import{b as Me}from"./chunk-AKGPCPJK.js";import{a as Ve,b as Le}from"./chunk-TC2VSDNX.js";import{a as y}from"./chunk-GP456TAF.js";import{a as Ee}from"./chunk-6I7PN7HP.js";import{a as Te,b as Ie}from"./chunk-QYOQXKGA.js";import{a as Be}from"./chunk-HQV6Q54H.js";import{a as Pe,b as $e,c as Ae}from"./chunk-Z2N3KAJX.js";import{b as ge,c as he,e as q,g as ve,h as be,j as h,l as Ce,n as xe,q as ye,x as Se,z as we}from"./chunk-ZUXETJBN.js";import{a as x,b as Fe,c as ke,e as Q}from"./chunk-LOXVGAEK.js";import{a as S,c as De}from"./chunk-QVSNJCSE.js";import{Ba as ne,Ca as g,Ha as d,Hb as O,Jb as z,La as ae,Ma as Z,Ob as ue,P as X,Pa as a,Qa as n,R as Y,Ra as m,Sa as le,Ta as me,V as C,Va as b,W as P,Wa as _,Xa as p,Y as v,Yb as _e,Z as D,_a as ee,a as F,ab as se,b as E,bb as ce,c as re,ca as f,cb as pe,d as k,da as u,eb as s,ec as te,f as oe,fb as de,gb as fe,mb as j,qa as $,sa as c,sb as H,t as W,tb as U,vb as G,wa as A,ya as N,za as R}from"./chunk-QYSCFILT.js";var T="brands",w=class i{constructor(r,e){this.baseHttpClient=r;this.httpClient=e}delete(r){return this.httpClient.delete(`${S.apiUrl}/${T}/${r}`)}toggleActive(r){return this.httpClient.delete(`${S.apiUrl}/${T}/${r}/active`)}create(r){return this.httpClient.post(`${S.apiUrl}/${T}`,this.baseHttpClient.getFormData(r))}update(r,e){return this.baseHttpClient.update(`${S.apiUrl}/${T}/${r}`,e)}getData(r){return this.httpClient.post(`${S.apiUrl}/${T}/search`,r)}static \u0275fac=function(e){return new(e||i)(v(ke),v(_e))};static \u0275prov=C({token:i,factory:i.\u0275fac,providedIn:"root"})};var He={data:{},filter:E(F({},Be),{sortBy:"name"})},M=class i extends Ee{constructor(e,t){super(He);this._api=e;this._globalStore=t}data$=this.select(({data:e})=>e);vm$=this.select({data:this.data$,filter:this.filter$},{debounce:!0});delete=this.effect(oe(Y(()=>this._globalStore.setLoading(!0)),X(e=>this._api.delete(e).pipe(x({next:t=>this._globalStore.setSuccess("Deleted successfully"),error:t=>this._globalStore.setError(y(t)),complete:()=>this._globalStore.setLoading(!1)})))));makeActive(e){return this._api.toggleActive(e.id).pipe(x({next:t=>{e.active=e.active?0:1,this.patchState(o=>({data:E(F({},o.data),{data:o.data.data.map(l=>l.id===e.id?e:l)})})),this._globalStore.setSuccess("Saved successfully")},error:t=>this._globalStore.setError(y(t)),finalize:()=>this._globalStore.setLoading(!1)}))}loadData=this.effect(e=>e.pipe(Y(()=>this._globalStore.setLoading(!0)),X(t=>this._api.getData(t).pipe(x({next:o=>this.patchState({data:o}),error:o=>this._globalStore.setError(y(o)),complete:()=>this._globalStore.setLoading(!1)})))));static \u0275fac=function(t){return new(t||i)(v(w),v(Q))};static \u0275prov=C({token:i,factory:i.\u0275fac})};var Ue={imagePreview:"",currentFile:void 0},I=class i extends Fe{constructor(e,t){super(Ue);this._api=e;this._globalStore=t}file$=this.select(e=>e.currentFile);image$=this.select(({imagePreview:e})=>e);vm$=this.select(e=>({imagePreview:e.imagePreview}));saveData=e=>{let L=e,{id:t}=L,o=re(L,["id"]),l=t?this._api.update(t,e):this._api.create(o);return this._globalStore.setLoading(!0),l.pipe(x({next:ie=>this._globalStore.setSuccess("Saved successfully"),error:ie=>{this._globalStore.setLoading(!1),this._globalStore.setError(y(ie))},finalize:()=>this._globalStore.setLoading(!1)}))};selectFile(e){this.patchState({imagePreview:""});let t=e.target.files;if(t){let o=t.item(0);if(o){this.patchState({imagePreview:"",currentFile:o});let l=new FileReader;l.onload=L=>{this.patchState({imagePreview:L.target.result})},l.readAsDataURL(o)}}}addImage=this.updater((e,t)=>({imagePreview:t}));static \u0275fac=function(t){return new(t||i)(v(w),v(Q))};static \u0275prov=C({token:i,factory:i.\u0275fac})};var ze=["modal"];function qe(i,r){if(i&1&&(a(0,"div",34),m(1,"img",35),n()),i&2){let e=r.ngIf;c(),d("src",e,$)}}function Qe(i,r){if(i&1){let e=b();a(0,"div",2)(1,"form",3)(2,"div",4)(3,"label",5),s(4,"Name"),n(),m(5,"input",6),n(),a(6,"div",4)(7,"label",7),s(8,"Slug"),n(),m(9,"input",8),n(),a(10,"div",9),m(11,"input",10),a(12,"label",11),s(13," Active "),n()(),a(14,"div",4)(15,"label",12),s(16,"Description"),n(),m(17,"input",13)(18,"p",14),n(),a(19,"div",4)(20,"label",15),s(21,"Meta Title"),n(),m(22,"input",16)(23,"p",14),n(),a(24,"div",4)(25,"label",17),s(26,"Meta Description"),n(),m(27,"input",18)(28,"p",14),n(),a(29,"div",4)(30,"label",19),s(31,"Meta Keywords"),n(),m(32,"input",20)(33,"p",14),n(),a(34,"div")(35,"label",21),s(36,"Upload Image"),n()(),a(37,"div",22),g(38,qe,2,1,"div",23),H(39,"async"),a(40,"div",24)(41,"label",25)(42,"span",26),m(43,"i",27),n(),a(44,"span",28),s(45,"Drop your images here or select "),a(46,"span",29),s(47,"click to browse"),n()(),a(48,"input",30),_("change",function(o){f(e);let l=p();return u(l._formStore.selectFile(o))}),n()()()(),a(49,"div",31)(50,"button",32),_("click",function(){f(e);let o=p();return u(o.closeMe())}),s(51," Close "),n(),a(52,"button",33),_("click",function(){f(e);let o=p();return u(o.save())}),s(53),n()()()()}if(i&2){let e=p();c(),d("formGroup",e.form),c(37),d("ngIf",U(39,7,e._formStore.image$)),c(14),ae("btn ",e.saveButtonClass,""),d("disabled",e.saveButtonDisabled),c(),fe(" ",e.saveButtonText," ")}}var V=class i extends Te{constructor(e){super();this.fb=e}content;form;_lookupStore=D(Me);_formStore=D(I);formVm$=this._formStore.vm$;ngOnInit(){this.initializeForm(),this.formData?.id&&this.patchForm(),this.form?.controls.name.valueChanges.subscribe(e=>{this.stringToSlug(e)})}save(){return k(this,null,function*(){let e=yield W(this._formStore.file$);if((e||this.formData?.image.length)&&this.form.controls.image.setErrors(null),this.form?.valid){let t={name:this.form.value.name,slug:this.form.value.slug,meta_title:this.form.value.meta_title??"",meta_description:this.form.value.meta_description??"",meta_keywords:this.form.value.meta_keywords??"",description:this.form.value.description??"",active:this.form.value.active===!0?1:0};e&&(t.image=e),this.form.value.id&&(t.id=this.form.value.id),this._formStore.saveData(t).subscribe(o=>{this.confirm()})}})}patchForm(){this.form?.patchValue({id:this.formData.id,name:this.formData.name,slug:this.formData.slug,meta_title:this.formData.meta_title??"",meta_description:this.formData.meta_description??"",meta_keywords:this.formData.meta_keywords??"",description:this.formData.description??"",active:this.formData.active}),this._formStore.addImage(this.formData.image)}initializeForm(){this.form=this.fb.group({id:new h(null),name:new h("",[q.required]),slug:new h("",[q.required]),image:new h("",[q.required]),meta_title:new h(""),meta_description:new h(""),meta_keywords:new h(""),description:new h(""),active:new h(!0)})}stringToSlug(e){let t=e.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-");this.form?.patchValue({slug:t})}getImageUrl(){return k(this,null,function*(){let e=yield W(this._formStore.image$);return!e||!e.length?this.form.controls.image.value:e})}static \u0275fac=function(t){return new(t||i)(A(Se))};static \u0275cmp=N({type:i,selectors:[["app-form"]],viewQuery:function(t,o){if(t&1&&se(ze,5),t&2){let l;ce(l=pe())&&(o.content=l.first)}},standalone:!1,features:[j([I]),ne],decls:2,vars:1,consts:[[1,"card","p-3"],["class","card-body",4,"ngIf"],[1,"card-body"],["admin-form","","method","POST","enctype","multipart/form-data",3,"formGroup"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","id","name","name","name","placeholder","Name","formControlName","name",1,"form-control"],["for","slug",1,"form-label"],["type","text","id","slug","name","slug","placeholder","Slug","formControlName","slug",1,"form-control"],[1,"form-check","mb-3"],["type","checkbox","formControlName","active","id","flexCheckDefault",1,"form-check-input"],["for","flexCheckDefault",1,"form-check-label"],["for","description",1,"form-label"],["type","text","id","description","name","description","placeholder","Description","formControlName","description",1,"form-control"],[1,"text-danger"],["for","meta_title",1,"form-label"],["type","text","id","meta_title","name","meta_title","placeholder","Meta Title","formControlName","meta_title",1,"form-control"],["for","meta_description",1,"form-label"],["type","text","id","meta_description","name","meta_description","placeholder","Meta Description","formControlName","meta_description",1,"form-control"],["for","meta_keywords",1,"form-label"],["type","text","id","meta_keywords","name","meta_keywords","placeholder","Meta Keywords","formControlName","meta_keywords",1,"form-control"],["for","exampleInputEmail1",1,"form-label"],[1,"upload-image","flex-grow"],["class","item","id","imgpreview",4,"ngIf"],["id","upload-file",1,"item","up-load"],["for","myFile",1,"uploadfile"],[1,"icon"],[1,"fa","fa-upload"],[1,"body-text"],[1,"tf-color"],["type","file","id","myFile","name","image","accept","image/*","formControlName","image",3,"change"],[1,"modal-footer"],["data-bs-dismiss","modal",1,"btn","btn-secondary",3,"click"],["type","submit",3,"click","disabled"],["id","imgpreview",1,"item"],["alt","",1,"effect8",3,"src"]],template:function(t,o){t&1&&(a(0,"div",0),g(1,Qe,54,9,"div",1),n()),t&2&&(c(),d("ngIf",o.form))},dependencies:[O,Ve,Le,Ce,he,ge,ve,be,xe,ye,z],encapsulation:2})};function Ke(i,r){if(i&1&&(a(0,"div",11),m(1,"img",12),a(2,"div",13)(3,"a",14),s(4),n()()()),i&2){let e=r.item;c(),ee("src",e.image,$),ee("alt",e.name),c(3),de(e.name)}}function Je(i,r){if(i&1){let e=b();a(0,"i",17),_("click",function(){f(e);let o=p().item,l=p(2);return u(l.makeActive(o))}),n()}}function We(i,r){if(i&1){let e=b();a(0,"i",18),_("click",function(){f(e);let o=p().item,l=p(2);return u(l.makeActive(o))}),n()}}function Xe(i,r){if(i&1&&g(0,Je,1,0,"i",15)(1,We,1,0,"i",16),i&2){let e=r.item;Z(e.active===!0?0:1)}}function Ye(i,r){i&1&&s(0," Hide ")}function Ze(i,r){i&1&&s(0,"Publish ")}function et(i,r){if(i&1){let e=b();a(0,"div",19)(1,"button",20),m(2,"i",21),n(),a(3,"ul",22)(4,"li")(5,"a",23),_("click",function(){let o=f(e).item,l=p(2);return u(l.edit(o))}),m(6,"i",24),s(7," Edit "),n()(),a(8,"li")(9,"a",23),_("click",function(){let o=f(e).item,l=p(2);return u(l.makeActive(o))}),m(10,"i",25),g(11,Ye,1,0)(12,Ze,1,0),n()(),a(13,"li")(14,"a",26),_("click",function(){let o=f(e).item,l=p(2);return u(l.delete(o))}),m(15,"i",27),s(16," Delete "),n()()()()}if(i&2){let e=r.item;c(11),Z(e.active?11:12)}}function tt(i,r){if(i&1){let e=b();le(0),a(1,"app-table",4),_("addButton",function(o){f(e);let l=p();return u(l.add(o))})("reload",function(){f(e);let o=p();return u(o.reload())})("changePage",function(o){f(e);let l=p();return u(l.pageChanged(o))}),m(2,"data-table-column",5),a(3,"data-table-column",6),g(4,Ke,5,3,"ng-template",null,2,G),n(),m(6,"data-table-column",7)(7,"data-table-column",8),a(8,"data-table-column",9),g(9,Xe,2,1,"ng-template",null,2,G),n(),a(11,"data-table-column",10),g(12,et,17,1,"ng-template",null,2,G),n()(),me()}if(i&2){let e=r.ngIf;c(),d("indexColumn",!1)("sortBy",e.filter==null?null:e.filter.sortBy)("sortDir",e.filter==null?null:e.filter.sortDir)("itemCount",e.data==null?null:e.data.total)("items",e.data==null?null:e.data.data)("searchText",e.filter==null?null:e.filter.searchText)("page",e.filter==null?null:e.filter.page),c(),d("sortable",!0),c(),d("sortable",!0),c(3),d("sortable",!0),c(),d("sortable",!0),c(),d("sortable",!1),c(3),d("sortable",!1)}}var K=class i{constructor(r){this.modalService=r}_store=D(M);vm$=this._store.vm$;ngOnInit(){this._store.loadData(this._store.filter$)}delete=r=>k(this,null,function*(){this.modalService.openConfirmationModal({modalTitle:"Are you sure?",modalBody:"click confirm or close"}).subscribe(e=>{this._store.delete(r.id),this._store.reset()})});edit(r){this.modalService.openModal(V,r,{modalTitle:"Edit Brand"}).subscribe(e=>{this._store.reset()})}add(r){r.preventDefault(),this.modalService.openModal(V,null,{modalTitle:"Create Brand"}).subscribe(e=>{this._store.reset()})}pageChanged(r){let e=[];e.push({column:"name",value:De(r),operator:"like"}),r=E(F({},r),{searchFilters:e}),this._store.updateFilter(r)}reload(){this._store.reset()}makeActive(r){let e=r.active?"This will hide the brand from the website, including the menu. Any products listed within the brand will no longer be accessible from inside the brand. They may still be accessible from any categories they are listed in":"This will show the brand from the website including the menu. Any products listed within the brand will become accessible from within it",t=r.active?"Hide":"Publish";this.modalService.openConfirmationModal({modalTitle:"Are you sure?",modalBody:e,saveButtonLabel:t}).subscribe(o=>{this._store.makeActive(r).subscribe()})}static \u0275fac=function(e){return new(e||i)(A(Ie))};static \u0275cmp=N({type:i,selectors:[["app-brand-list"]],standalone:!1,features:[j([M])],decls:6,vars:3,consts:[["confirmationModal",""],["modal",""],["dataTableCell",""],[4,"ngIf"],["headerTitle","Brands",3,"addButton","reload","changePage","indexColumn","sortBy","sortDir","itemCount","items","searchText","page"],["header","#","property","id",3,"sortable"],["header","Name","property","name",3,"sortable"],["header","Slug","property","slug",3,"sortable"],["header","Products","property","products",3,"sortable"],["header","Active","property","active",3,"sortable"],["header","Action",3,"sortable"],[1,"d-flex","align-items-center","justify-content-between","me-3"],[1,"image",2,"width","100px",3,"src","alt"],[1,""],["href","#",1,"fw-bold"],[1,"fa","fa-check",2,"cursor","pointer"],[1,"fa","fa-times-circle",2,"cursor","pointer"],[1,"fa","fa-check",2,"cursor","pointer",3,"click"],[1,"fa","fa-times-circle",2,"cursor","pointer",3,"click"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown","aria-expanded","false","aria-label","Settings",1,"btn","btn-icon","btn-ghost","rounded-circle"],[1,"fa-solid","fa-ellipsis-vertical",2,"font-size","22px"],[1,"dropdown-menu","dropdown-menu-end"],["href","javascript:void(0)",1,"dropdown-item",3,"click"],[1,"fa","fa-edit","opacity-75","me-2"],[1,"fa","fa-archive","opacity-75","me-2"],["href","javascript:void(0)",1,"dropdown-item","text-danger",3,"click"],[1,"fa","fa-trash","opacity-75","me-2"]],template:function(e,t){e&1&&(g(0,tt,14,13,"ng-container",3),H(1,"async"),m(2,"div",null,0)(4,"div",null,1)),e&2&&d("ngIf",U(1,1,t.vm$))},dependencies:[O,$e,Pe,z],encapsulation:2})};var it=[{path:"",component:K}],J=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=R({type:i});static \u0275inj=P({imports:[te.forChild(it),te]})};var Re=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=R({type:i});static \u0275inj=P({imports:[ue,J,Ae,we]})};export{Re as BrandsModule};
