import{b as Oe}from"./chunk-DZZTNLX6.js";import{a as Ge}from"./chunk-NZWW7WBW.js";import{a as Be}from"./chunk-72ZV2RTL.js";import{a as Ne,b as Re}from"./chunk-TC2VSDNX.js";import{a as y}from"./chunk-GP456TAF.js";import{a as Ie}from"./chunk-6I7PN7HP.js";import{a as Le,b as $e}from"./chunk-QYOQXKGA.js";import{a as Me}from"./chunk-HQV6Q54H.js";import{a as Ae,b as je,c as He}from"./chunk-Z2N3KAJX.js";import{b as he,c as be,e as b,g as Ce,h as xe,j as g,l as Se,n as ye,q as we,r as Fe,s as Ee,u as Ue,x as De,z as ke}from"./chunk-ZUXETJBN.js";import{a as S,b as Te,c as Ve,e as K}from"./chunk-LOXVGAEK.js";import{a as w,c as Pe}from"./chunk-QVSNJCSE.js";import{Ba as ae,Ca as _,Gb as ue,Ha as c,Hb as z,Jb as Q,La as le,Ma as Z,Mb as _e,Ob as ve,P as X,Pa as a,Qa as n,R as Y,Ra as p,Sa as me,Ta as se,V as x,Va as C,W as R,Wa as v,Xa as d,Y as h,Yb as ge,Z as A,_a as k,a as U,ab as pe,b as D,bb as ce,c as re,ca as f,cb as de,d as N,da as u,eb as m,ec as te,f as oe,fb as fe,gb as ee,mb as G,qa as j,sa as s,sb as M,t as ne,tb as T,vb as q,wa as B,ya as H,za as O}from"./chunk-QYSCFILT.js";var I="users",F=class t{constructor(i,e){this.baseHttpClient=i;this.httpClient=e}delete(i){return this.httpClient.delete(`${w.apiUrl}/${I}/${i}`)}toggleActive(i){return this.httpClient.delete(`${w.apiUrl}/${I}/${i}/active`)}create(i){return this.httpClient.post(`${w.apiUrl}/${I}`,this.baseHttpClient.getFormData(i))}update(i,e){return this.baseHttpClient.update(`${w.apiUrl}/${I}/${i}`,e)}getData(i){return this.httpClient.post(`${w.apiUrl}/${I}/search`,i)}static \u0275fac=function(e){return new(e||t)(h(Ve),h(ge))};static \u0275prov=x({token:t,factory:t.\u0275fac,providedIn:"root"})};var Ke={data:{},filter:D(U({},Me),{sortBy:"name"})},V=class t extends Ie{constructor(e,r){super(Ke);this._api=e;this._globalStore=r}data$=this.select(({data:e})=>e);vm$=this.select({data:this.data$,filter:this.filter$},{debounce:!0});delete=this.effect(oe(Y(()=>this._globalStore.setLoading(!0)),X(e=>this._api.delete(e).pipe(S({next:r=>this._globalStore.setSuccess("Deleted successfully"),error:r=>this._globalStore.setError(y(r)),finalize:()=>this._globalStore.setLoading(!1)})))));makeActive(e){return this._api.toggleActive(e.id).pipe(S({next:r=>{e.active=e.active?0:1,this.patchState(o=>({data:D(U({},o.data),{data:o.data.data.map(l=>l.id===e.id?e:l)})})),this._globalStore.setSuccess("Saved successfully")},error:r=>this._globalStore.setError(y(r)),finalize:()=>this._globalStore.setLoading(!1)}))}loadData=this.effect(e=>e.pipe(Y(()=>this._globalStore.setLoading(!0)),X(r=>this._api.getData(r).pipe(S({next:o=>this.patchState({data:o}),error:o=>this._globalStore.setError(y(o)),complete:()=>this._globalStore.setLoading(!1)})))));static \u0275fac=function(r){return new(r||t)(h(F),h(K))};static \u0275prov=x({token:t,factory:t.\u0275fac})};var Je={imagePreview:"",currentFile:void 0},P=class t extends Te{constructor(e,r){super(Je);this._api=e;this._globalStore=r}file$=this.select(e=>e.currentFile);image$=this.select(({imagePreview:e})=>e);vm$=this.select(e=>({imagePreview:e.imagePreview}));saveData=e=>{let $=e,{id:r}=$,o=re($,["id"]),l=r?this._api.update(r,e):this._api.create(o);return this._globalStore.setLoading(!0),l.pipe(S({next:ie=>{this._globalStore.setSuccess("Saved successfully")},error:ie=>{this._globalStore.setLoading(!1),this._globalStore.setError(y(ie))},finalize:()=>this._globalStore.setLoading(!1)}))};selectFile(e){this.patchState({imagePreview:""});let r=e.target.files;if(r){let o=r.item(0);if(o){this.patchState({imagePreview:"",currentFile:o});let l=new FileReader;l.onload=$=>{this.patchState({imagePreview:$.target.result})},l.readAsDataURL(o)}}}addImage=this.updater((e,r)=>({imagePreview:r}));static \u0275fac=function(r){return new(r||t)(h(F),h(K))};static \u0275prov=x({token:t,factory:t.\u0275fac})};var Ye=["modal"];function Ze(t,i){if(t&1&&(a(0,"option",29),m(1),n()),t&2){let e=i.$implicit;k("value",e.value),s(),ee(" ",e.key," ")}}function et(t,i){if(t&1&&(a(0,"div",30),p(1,"img",31),n()),t&2){let e=i.ngIf;s(),c("src",e,j)}}function tt(t,i){if(t&1){let e=C();a(0,"div",2)(1,"form",3)(2,"div",4)(3,"label",5),m(4,"Name"),n(),p(5,"input",6),n(),a(6,"div",4)(7,"label",5),m(8,"Mobile"),n(),p(9,"input",7),n(),a(10,"div",4)(11,"label",5),m(12,"Email"),n(),p(13,"input",8),n(),a(14,"div",4)(15,"label",5),m(16,"Password"),n(),p(17,"input",9),n(),a(18,"div",4)(19,"label",5),m(20,"Confirm Password"),n(),p(21,"input",10),n(),a(22,"div",4)(23,"label",5),m(24,"Role"),n(),a(25,"select",11)(26,"option",12),m(27,"Select Role"),n(),_(28,Ze,2,2,"option",13),M(29,"keyvalue"),n()(),a(30,"div",14),p(31,"input",15),a(32,"label",16),m(33,"Active"),n()(),a(34,"div")(35,"label",5),m(36,"Upload Image"),n()(),a(37,"div",17),_(38,et,2,1,"div",18),M(39,"async"),a(40,"div",19)(41,"label",20)(42,"span",21),p(43,"i",22),n(),a(44,"span",23),m(45,"Drop your images here or select "),a(46,"span",24),m(47,"click to browse"),n()(),a(48,"input",25),v("change",function(o){f(e);let l=d();return u(l._formStore.selectFile(o))}),n()()()(),a(49,"div",26)(50,"button",27),v("click",function(){f(e);let o=d();return u(o.closeMe())}),m(51," Close "),n(),a(52,"button",28),v("click",function(){f(e);let o=d();return u(o.save())}),m(53),n()()()()}if(t&2){let e=d();s(),c("formGroup",e.form),s(27),c("ngForOf",T(29,8,e.RoleEnum)),s(10),c("ngIf",T(39,10,e._formStore.image$)),s(14),le("btn ",e.saveButtonClass,""),c("disabled",e.saveButtonDisabled),s(),ee(" ",e.saveButtonText," ")}}var L=class t extends Le{constructor(e){super();this.fb=e}content;form;_formStore=A(P);formVm$=this._formStore.vm$;ngOnInit(){this.initializeForm(),this.formData?.id&&this.patchForm()}save(){return N(this,null,function*(){if(this.form?.valid){let e=yield ne(this._formStore.file$),r={name:this.form.value.name,email:this.form.value.email,mobile:this.form.value.mobile,password:this.form.value.password,utype:this.form.value.utype,active:this.form.value.active===!0?1:0};e&&(r.image=e),this.form.value.id&&(r.id=this.form.value.id),this._formStore.saveData(r).subscribe(o=>{this.confirm()})}})}patchForm(){this.form?.patchValue({id:this.formData.id,name:this.formData.name,email:this.formData.email,mobile:this.formData.mobile,password:this.formData.password,utype:this.formData.utype,active:this.formData.active}),this._formStore.addImage(this.formData.image)}initializeForm(){this.form=this.fb.group({id:new g(null),name:new g("",[b.required]),email:new g("",[b.required,b.email]),mobile:new g("",[b.required]),password:new g("",[b.required]),confirm:new g("",[b.required]),utype:new g("",[b.required]),active:new g(!0,[b.required]),image:new g("")}),this.form.get("confirm").setValidators(Oe(this.form.get("password")))}RoleEnum=Ge;static \u0275fac=function(r){return new(r||t)(B(De))};static \u0275cmp=H({type:t,selectors:[["app-form"]],viewQuery:function(r,o){if(r&1&&pe(Ye,5),r&2){let l;ce(l=de())&&(o.content=l.first)}},standalone:!1,features:[G([P]),ae],decls:2,vars:1,consts:[[1,"card","p-3"],["class","card-body",4,"ngIf"],[1,"card-body"],["admin-form","","method","POST","enctype","multipart/form-data",3,"formGroup"],[1,"mb-3"],["for","exampleInputEmail1",1,"form-label"],["type","text","id","name","name","name","placeholder","Name","formControlName","name",1,"form-control"],["type","text","id","mobile","name","mobile","placeholder","Mobile","formControlName","mobile",1,"form-control"],["type","email","id","email","name","email","placeholder","Email","formControlName","email",1,"form-control"],["type","password","id","password","name","password","placeholder","Password","formControlName","password",1,"form-control"],["type","password","id","confirm","name","confirm","placeholder","Password","formControlName","confirm",1,"form-control"],["id","utype","name","utype","formControlName","utype",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-check","form-switch"],["type","checkbox","role","switch","id","flexSwitchCheckDefault","name","active","formControlName","active",1,"form-check-input"],["for","flexSwitchCheckDefault",1,"form-check-label"],[1,"upload-image","flex-grow"],["class","item","id","imgpreview",4,"ngIf"],["id","upload-file",1,"item","up-load"],["for","myFile",1,"uploadfile"],[1,"icon"],[1,"fa","fa-upload"],[1,"body-text"],[1,"tf-color"],["type","file","id","myFile","name","image","accept","image/*","formControlName","image",3,"change"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"click"],["type","submit",3,"click","disabled"],[3,"value"],["id","imgpreview",1,"item"],["alt","",1,"effect8",3,"src"]],template:function(r,o){r&1&&(a(0,"div",0),_(1,tt,54,12,"div",1),n()),r&2&&(s(),c("ngIf",o.form))},dependencies:[ue,z,Ne,Re,Se,Ee,Ue,be,he,Fe,Ce,xe,ye,we,Q,_e],encapsulation:2})};function it(t,i){if(t&1&&(a(0,"div",11),p(1,"img",12),a(2,"div",13)(3,"a",14),m(4),n()()()),t&2){let e=i.item;s(),k("src",e.image,j),k("alt",e.name),s(3),fe(e.name)}}function rt(t,i){if(t&1){let e=C();a(0,"i",17),v("click",function(){f(e);let o=d().item,l=d(2);return u(l.makeActive(o))}),n()}}function ot(t,i){if(t&1){let e=C();a(0,"i",18),v("click",function(){f(e);let o=d().item,l=d(2);return u(l.makeActive(o))}),n()}}function nt(t,i){if(t&1&&_(0,rt,1,0,"i",15)(1,ot,1,0,"i",16),t&2){let e=i.item;Z(e.active===!0?0:1)}}function at(t,i){t&1&&m(0," Hide ")}function lt(t,i){t&1&&m(0,"Activate ")}function mt(t,i){if(t&1){let e=C();a(0,"div",19)(1,"button",20),p(2,"i",21),n(),a(3,"ul",22)(4,"li")(5,"a",23),v("click",function(){let o=f(e).item,l=d(2);return u(l.edit(o))}),p(6,"i",24),m(7," Edit "),n()(),a(8,"li")(9,"a",23),v("click",function(){let o=f(e).item,l=d(2);return u(l.makeActive(o))}),p(10,"i",25),_(11,at,1,0)(12,lt,1,0),n()(),a(13,"li")(14,"a",26),v("click",function(){let o=f(e).item,l=d(2);return u(l.delete(o))}),p(15,"i",27),m(16," Delete "),n()()()()}if(t&2){let e=i.item;s(11),Z(e.active?11:12)}}function st(t,i){if(t&1){let e=C();me(0),a(1,"app-table",4),v("addButton",function(o){f(e);let l=d();return u(l.add(o))})("reload",function(){f(e);let o=d();return u(o.reload())})("changePage",function(o){f(e);let l=d();return u(l.pageChanged(o))}),p(2,"data-table-column",5),a(3,"data-table-column",6),_(4,it,5,3,"ng-template",null,2,q),n(),p(6,"data-table-column",7)(7,"data-table-column",8),a(8,"data-table-column",9),_(9,nt,2,1,"ng-template",null,2,q),n(),a(11,"data-table-column",10),_(12,mt,17,1,"ng-template",null,2,q),n()(),se()}if(t&2){let e=i.ngIf;s(),c("indexColumn",!1)("sortBy",e.filter==null?null:e.filter.sortBy)("sortDir",e.filter==null?null:e.filter.sortDir)("searchText",e.filter==null?null:e.filter.searchText)("itemCount",e.data==null?null:e.data.total)("items",e.data==null?null:e.data.data)("page",e.filter==null?null:e.filter.page),s(),c("sortable",!0),s(),c("sortable",!0),s(3),c("sortable",!0),s(),c("sortable",!0),s(),c("sortable",!1),s(3),c("sortable",!1)}}var J=class t{constructor(i){this.modalService=i}_store=A(V);vm$=this._store.vm$;ngOnInit(){this._store.loadData(this._store.filter$)}edit(i){this.modalService.openModal(L,i,{modalTitle:"Edit User"}).subscribe(e=>{this._store.reset()})}delete=i=>N(this,null,function*(){this.modalService.openConfirmationModal({modalTitle:"Are you sure?",modalBody:"click confirm or close"}).subscribe(e=>{this._store.delete(i.id),this._store.reset()})});makeActive(i){let e=i.active?"This will prevent the user from being able to log in. They will no longer be able to access their account":"This will mean the user can log in and access their account",r=i.active?"Hide":"Publish";this.modalService.openConfirmationModal({modalTitle:"Are you sure?",modalBody:e,saveButtonLabel:r}).subscribe(o=>{this._store.makeActive(i).subscribe()})}add(i){i.preventDefault(),this.modalService.openModal(L,null,{modalTitle:"Create User"}).subscribe(e=>{this._store.reset()})}pageChanged(i){let e=[];e.push({column:"name",value:Pe(i),operator:"like"}),i=D(U({},i),{searchFilters:e}),this._store.updateFilter(i)}reload(){this._store.reset()}static \u0275fac=function(e){return new(e||t)(B($e))};static \u0275cmp=H({type:t,selectors:[["app-user-list"]],standalone:!1,features:[G([V])],decls:6,vars:3,consts:[["confirmationModal",""],["modal",""],["dataTableCell",""],[4,"ngIf"],["headerTitle","Users",3,"addButton","reload","changePage","indexColumn","sortBy","sortDir","searchText","itemCount","items","page"],["header","#","property","id",3,"sortable"],["header","Name","property","name",3,"sortable"],["header","Email","property","email",3,"sortable"],["header","Mobile","property","mobile",3,"sortable"],["header","Active","property","active",3,"sortable"],["header","Action",3,"sortable"],[1,"d-flex","align-items-center","justify-content-between","me-3"],[1,"image",2,"width","100px",3,"src","alt"],[1,""],["href","#",1,"fw-bold"],[1,"fa","fa-check",2,"cursor","pointer"],[1,"fa","fa-times-circle",2,"cursor","pointer"],[1,"fa","fa-check",2,"cursor","pointer",3,"click"],[1,"fa","fa-times-circle",2,"cursor","pointer",3,"click"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown","aria-expanded","false","aria-label","Settings",1,"btn","btn-icon","btn-ghost","rounded-circle"],[1,"fa-solid","fa-ellipsis-vertical",2,"font-size","22px"],[1,"dropdown-menu","dropdown-menu-end"],["href","javascript:void(0)",1,"dropdown-item",3,"click"],[1,"fa","fa-edit","opacity-75","me-2"],[1,"fa","fa-archive","opacity-75","me-2"],["href","javascript:void(0)",1,"dropdown-item","text-danger",3,"click"],[1,"fa","fa-trash","opacity-75","me-2"]],template:function(e,r){e&1&&(_(0,st,14,13,"ng-container",3),M(1,"async"),p(2,"div",null,0)(4,"div",null,1)),e&2&&c("ngIf",T(1,1,r.vm$))},dependencies:[z,je,Ae,Q],encapsulation:2})};var pt=[{path:"",component:J}],W=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=O({type:t});static \u0275inj=R({imports:[te.forChild(pt),te]})};var ze=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=O({type:t});static \u0275inj=R({imports:[ve,W,Be,He,ke]})};export{ze as UsersModule};
