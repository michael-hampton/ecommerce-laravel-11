import{b as Ce}from"./chunk-TC2VSDNX.js";import{a as R}from"./chunk-GP456TAF.js";import{a as Q}from"./chunk-HQV6Q54H.js";import{c as Se}from"./chunk-Z2N3KAJX.js";import{c as re,e as se,g as me,h as le,j as pe,l as ce,n as ge,q as de,x as ue,z as fe}from"./chunk-ZUXETJBN.js";import{a as V,b as xe,c as he,e as be}from"./chunk-LOXVGAEK.js";import{a as E}from"./chunk-QVSNJCSE.js";import{Ca as c,Gb as M,Ha as s,Hb as F,Jb as L,Ka as C,Ob as ae,P as ee,Pa as o,Qa as r,R as $,Ra as d,Sa as T,Ta as j,V as z,Va as x,W as B,Wa as u,Xa as p,Y as S,Yb as oe,Z as y,a as W,ac as _e,b as J,ba as te,ca as f,da as _,dc as ve,eb as m,ec as K,fb as g,ja as ie,mb as k,pb as ne,qa as v,sa as a,sb as w,tb as D,ya as P,za as N}from"./chunk-QYSCFILT.js";var O="messages",U=class t{constructor(i,e){this.baseHttpClient=i;this.httpClient=e}delete(i){return this.httpClient.delete(`${E.apiUrl}/${O}/${i}`)}create(i){let e=this.baseHttpClient.getFormData(i);return Array.from(i.images).forEach(n=>{e.append("images[]",n)}),this.httpClient.post(`${E.apiUrl}/${O}`,e)}update(i,e){return this.httpClient.put(`${E.apiUrl}/${O}/${i}`,e)}getData(i){return this.baseHttpClient.get(i,O)}getMessageDetails(i){return this.httpClient.get(`${E.apiUrl}/${O}/${i}`)}static \u0275fac=function(e){return new(e||t)(S(he),S(oe))};static \u0275prov=z({token:t,factory:t.\u0275fac,providedIn:"root"})};var Ie={data:{},filter:J(W({},Q),{sortBy:"created_at",sortDir:"desc"}),message:{},loading:!1,previews:[]},h=class t extends xe{constructor(e,n){super(Ie);this._api=e;this._globalStore=n}data$=this.select(({data:e})=>e);message$=this.select(({message:e})=>e);filter$=this.select(({filter:e})=>e);files$=this.select(e=>e.selectedFiles);galleryImages$=this.select(({previews:e})=>e);vm$=this.select({data:this.data$,message:this.message$},{debounce:!0});createReply=e=>this._api.create(e).pipe($(()=>this.patchState({loading:!0})),V({next:n=>{this._globalStore.setSuccess("Saved successfully")},error:n=>{this._globalStore.setError(R(n))},complete:()=>this.patchState({loading:!1})}));loadData=this.effect(e=>e.pipe($(()=>this._globalStore.setLoading(!0)),ee(n=>this._api.getData(n).pipe(V({next:l=>this.patchState({data:l}),error:l=>this._globalStore.setError(R(l)),complete:()=>this._globalStore.setLoading(!1)})))));getMessageDetails(e){return this._api.getMessageDetails(e).pipe($(()=>this.patchState({loading:!0})),V({next:n=>{console.log("message",n),this.patchState({message:n})},error:n=>{this._globalStore.setError(R(n))},complete:()=>this.patchState({loading:!1})}))}updatePage(e){this.patchState({filter:J(W({},Q),{page:e,sortBy:"created_at",sortDir:"desc"})})}bulkUpload(e){let n=e.target.files;this.patchState({selectedFiles:n});let l=[];if(n&&n[0]){let b=n.length;for(let q=0;q<b;q++){let X=new FileReader;X.onload=Z=>{console.log(Z.target.result),l.push(Z.target.result)},X.readAsDataURL(n[q])}this.patchState({previews:l})}}static \u0275fac=function(n){return new(n||t)(S(U),S(be))};static \u0275prov=z({token:t,factory:t.\u0275fac})};function we(t,i){if(t&1){let e=x();o(0,"li")(1,"button",2),u("click",function(){f(e);let l=p();return _(l.selectPageNumber(1))}),m(2,"\xAB\xAB"),r()()}if(t&2){let e=p();C(e.currentPage===1?"page-item disabled":"page-item")}}function De(t,i){if(t&1){let e=x();o(0,"li")(1,"button",2),u("click",function(){f(e);let l=p();return _(l.previous())}),m(2,"\xAB"),r()()}if(t&2){let e=p();C(e.currentPage===1?"page-item disabled":"page-item")}}function Ee(t,i){if(t&1){let e=x();o(0,"li")(1,"button",2),u("click",function(){f(e);let l=p().index,b=p();return _(b.selectPageNumber(l+1))}),m(2),r()()}if(t&2){let e=p().index,n=p();C(n.currentPage===e+1?"page-item active":"page-item"),a(2),g(e+1)}}function Oe(t,i){if(t&1&&(T(0),c(1,Ee,3,3,"li",0),j()),t&2){let e=i.index,n=p();a(),s("ngIf",e+1>=n.currentPage-n.maxSize&&e+1<=n.currentPage+n.maxSize)}}function $e(t,i){if(t&1){let e=x();o(0,"li")(1,"button",2),u("click",function(){f(e);let l=p();return _(l.next())}),m(2,"\xBB"),r()()}if(t&2){let e=p();C(e.currentPage===e.totalPages.length?"page-item disabled":"page-item")}}function ze(t,i){if(t&1){let e=x();o(0,"li")(1,"button",2),u("click",function(){f(e);let l=p();return _(l.selectPageNumber(l.totalPages.length))}),m(2,"\xBB\xBB"),r()()}if(t&2){let e=p();C(e.currentPage===e.totalPages.length?"page-item disabled":"page-item")}}var A=class t{collectionSize=0;pageSize=5;currentPage=1;maxSize=2;firstLastButtons=!1;nextPreviousButtons=!0;small=!1;paginationChanged=new ie;totalPages=[];constructor(){}ngOnInit(){this.totalPages=new Array(Math.ceil(this.collectionSize/this.pageSize))}ngOnChanges(i){this.totalPages=new Array(Math.ceil(this.collectionSize/this.pageSize))}selectPageNumber(i){this.currentPage=i,this.paginationChanged.emit(i)}next(){let i=this.currentPage+1;i<=this.totalPages.length&&this.selectPageNumber(i),this.paginationChanged.emit(i)}previous(){let i=this.currentPage-1;i>=1&&this.selectPageNumber(i),this.paginationChanged.emit(i)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=P({type:t,selectors:[["app-pagination"]],inputs:{collectionSize:"collectionSize",pageSize:"pageSize",currentPage:"currentPage",maxSize:"maxSize",firstLastButtons:"firstLastButtons",nextPreviousButtons:"nextPreviousButtons",small:"small"},outputs:{paginationChanged:"paginationChanged"},standalone:!1,features:[te],decls:7,vars:7,consts:[[3,"class",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"page-link",3,"click"]],template:function(e,n){e&1&&(o(0,"nav")(1,"ul"),c(2,we,3,2,"li",0)(3,De,3,2,"li",0)(4,Oe,2,1,"ng-container",1)(5,$e,3,2,"li",0)(6,ze,3,2,"li",0),r()()),e&2&&(a(),C(n.small?"pagination pagination-sm":"pagination"),a(),s("ngIf",n.firstLastButtons),a(),s("ngIf",n.nextPreviousButtons),a(),s("ngForOf",n.totalPages),a(),s("ngIf",n.nextPreviousButtons),a(),s("ngIf",n.firstLastButtons))},dependencies:[M,F],encapsulation:2})};var Ne=t=>["details",t];function Te(t,i){if(t&1&&(o(0,"div",9)(1,"div",10),d(2,"img",11),o(3,"div",12)(4,"div",13)(5,"a",14)(6,"h6",15),m(7),r()(),o(8,"span",16),m(9),r()(),o(10,"span",17),m(11),r(),o(12,"p",18),m(13),r(),o(14,"div",19)(15,"a",20),d(16,"i",21),m(17," Read More"),r()()()(),d(18,"hr",22),r()),t&2){let e=i.$implicit;a(2),s("src",e.user.image,v),a(5),g(e.user.name),a(2),g(e.created_at),a(2),g(e.title),a(2),g(e.message),a(2),s("routerLink",ne(6,Ne,e.id))}}function je(t,i){if(t&1){let e=x();o(0,"div",4)(1,"div",5)(2,"div",6),c(3,Te,19,8,"div",7),r()(),o(4,"app-pagination",8,0),u("paginationChanged",function(l){f(e);let b=p();return _(b.paginationChanged(l))}),r()()}if(t&2){let e=i.ngIf;a(3),s("ngForOf",e.data.data),a(),s("collectionSize",e.data.total)("pageSize",e.data.per_page)("firstLastButtons",!0)("maxSize",10)}}var H=class t{_store=y(h);vm$=this._store.vm$;ngOnInit(){this._store.loadData(this._store.filter$)}paginationChanged(i){this._store.updatePage(i)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=P({type:t,selectors:[["app-list"]],standalone:!1,features:[k([h])],decls:4,vars:3,consts:[["pagination",""],[1,"main-content-inner"],[1,"main-content-wrap"],["class","container",4,"ngIf"],[1,"container"],[1,"comment-section"],[1,"comments-list"],["class","comment-box mb-4",4,"ngFor","ngForOf"],[3,"paginationChanged","collectionSize","pageSize","firstLastButtons","maxSize"],[1,"comment-box","mb-4"],[1,"d-flex","gap-3"],["alt","User Avatar",1,"user-avatar",2,"width","100px",3,"src"],[1,"flex-grow-1"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],["href","javscript:void(0)"],[1,"mb-0"],[1,"comment-time"],[1,"text-muted"],[1,"mb-2"],[1,"comment-actions"],["href","javascript:void(0)",3,"routerLink"],[1,"bi","bi-share"],[1,"bg-danger","border-2","border-top","border-secondary-subtle"]],template:function(e,n){e&1&&(o(0,"div",1)(1,"div",2),c(2,je,6,5,"div",3),w(3,"async"),r()()),e&2&&(a(2),s("ngIf",D(3,1,n.vm$)))},dependencies:[M,F,ve,A,L],encapsulation:2})};function ke(t,i){if(t&1&&d(0,"img",22),t&2){let e=i.$implicit;s("src",e,v)}}function Le(t,i){if(t&1&&(o(0,"div",20),c(1,ke,1,1,"img",21),r()),t&2){let e=i.ngIf;a(),s("ngForOf",e)}}function Ve(t,i){if(t&1&&d(0,"img",22),t&2){let e=i.$implicit;s("src",e,v)}}function Re(t,i){if(t&1&&(o(0,"div",34),c(1,Ve,1,1,"img",21),r()),t&2){let e=p(2).ngIf;a(),s("ngForOf",e.message.images)}}function Ue(t,i){if(t&1&&d(0,"img",22),t&2){let e=i.$implicit;s("src",e,v)}}function Ae(t,i){if(t&1&&(o(0,"div",34),c(1,Ue,1,1,"img",21),r()),t&2){let e=p().$implicit;a(),s("ngForOf",e.images)}}function He(t,i){if(t&1&&(o(0,"div",25)(1,"div",3),d(2,"img",26),o(3,"div",5)(4,"div",27)(5,"h6",28),m(6),r(),o(7,"span",29),m(8),r()(),o(9,"p",30),m(10),r()()(),c(11,Ae,2,1,"div",31),r()),t&2){let e=i.$implicit;a(2),s("src",e.user.image,v),a(4),g(e.user.name),a(2),g(e.created_at),a(2),g(e.message),a(),s("ngIf",e.images)}}function Ge(t,i){if(t&1&&(o(0,"div",24)(1,"div",25)(2,"div",3),d(3,"img",26),o(4,"div",5)(5,"div",27)(6,"h6",28),m(7),r(),o(8,"span",29),m(9),r()(),o(10,"p",30),m(11),r()(),c(12,Re,2,1,"div",31),r(),o(13,"div",32),c(14,He,12,5,"div",33),r()()()),t&2){let e=p().ngIf;a(3),s("src",e.message==null||e.message.user==null?null:e.message.user.image,v),a(4),g(e.message==null||e.message.user==null?null:e.message.user.name),a(2),g(e.message==null?null:e.message.created_at),a(2),g(e.message==null?null:e.message.message),a(),s("ngIf",e.message.images),a(2),s("ngForOf",e.message==null?null:e.message.comments)}}function Ye(t,i){if(t&1&&(T(0),c(1,Ge,15,6,"div",23),j()),t&2){let e=i.ngIf;a(),s("ngIf",e.message)}}var G=class t{activatedRoute=y(_e);messageId;_store=y(h);vm$=this._store.vm$;fb=y(ue);myForm;ngOnInit(){this.activatedRoute.params.subscribe(i=>{this.messageId=i.id,this._store.getMessageDetails(this.messageId).subscribe()}),this._store.files$.subscribe(i=>{this.myForm.patchValue({imagesSource:i})}),this.initializeForm()}initializeForm(){this.myForm=this.fb.group({message:["",se.required],imagesSource:new pe("")})}onSubmit(){this.myForm.valid&&this._store.createReply({postId:this.messageId,message:this.myForm.value.message,images:this.myForm.value.imagesSource}).subscribe(i=>{this.myForm.reset(),this._store.getMessageDetails(this.messageId).subscribe()})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=P({type:t,selectors:[["app-details"]],standalone:!1,features:[k([h])],decls:27,vars:8,consts:[[1,"comment-section"],["method","post",3,"ngSubmit","formGroup"],[1,"mb-4"],[1,"d-flex","gap-3"],["src","https://randomuser.me/api/portraits/women/4.jpg","alt","User Avatar",1,"user-avatar"],[1,"flex-grow-1"],["formControlName","message","name","message","rows","3","placeholder","Write a comment...",1,"form-control","comment-input"],[1,"body-title"],[1,"upload-image","mb-16"],["id","galUpload",1,"item","up-load"],["for","gFile",1,"uploadfile"],[1,"icon"],[1,"fa","fa-upload"],[1,"text-tiny"],[1,"tf-color"],["formControlName","images","type","file","id","gFile","name","images[]","accept","image/*","multiple","",3,"change"],["class","d-flex align-items-center justify-content-between",4,"ngIf"],[1,"mt-4","text-end"],["type","submit",1,"btn","btn-comment","text-white",3,"disabled"],[4,"ngIf"],[1,"d-flex","align-items-center","justify-content-between"],["style","width: 100px",3,"src",4,"ngFor","ngForOf"],[2,"width","100px",3,"src"],["class","comments-list","style","height: 500px; overflow-y: auto",4,"ngIf"],[1,"comments-list",2,"height","500px","overflow-y","auto"],[1,"comment-box"],["alt","User Avatar",1,"user-avatar",3,"src"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"mb-0"],[1,"comment-time"],[1,"mb-2"],["class","d-flex justify-content-between",4,"ngIf"],[1,"reply-section","mt-3"],["class","comment-box",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"form",1),u("ngSubmit",function(){return n.onSubmit()}),o(2,"div",2)(3,"div",3),d(4,"img",4),o(5,"div",5),d(6,"textarea",6),o(7,"div")(8,"div",7),m(9,"Upload Gallery Images"),r(),o(10,"div",8)(11,"div",9)(12,"label",10)(13,"span",11),d(14,"i",12),r(),o(15,"span",13),m(16,"Drop your images here or select "),o(17,"span",14),m(18,"click to browse"),r()(),o(19,"input",15),u("change",function(b){return n._store.bulkUpload(b)}),r()()()(),c(20,Le,2,1,"div",16),w(21,"async"),r(),o(22,"div",17)(23,"button",18),m(24,"Post Reply"),r()()()()()(),c(25,Ye,2,1,"ng-container",19),w(26,"async"),r()),e&2&&(a(),s("formGroup",n.myForm),a(19),s("ngIf",D(21,4,n._store.galleryImages$)),a(3),s("disabled",n.myForm.invalid),a(2),s("ngIf",D(26,6,n.vm$)))},dependencies:[M,F,ce,re,me,le,ge,de,Ce,L],styles:[".comment-section[_ngcontent-%COMP%]{max-width:800px;margin:2rem auto;padding:20px;background:#f8f9fa;border-radius:15px;box-shadow:0 2px 15px #0000001a}.comment-box[_ngcontent-%COMP%]{background:#fff;border-radius:10px;padding:20px;margin-bottom:20px;transition:transform .2s;border:1px solid #e9ecef}.comment-box[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 5px 15px #0000001a}.user-avatar[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%;object-fit:cover}.comment-input[_ngcontent-%COMP%]{border-radius:20px;padding:15px 20px;border:2px solid #e9ecef;transition:all .3s}.comment-input[_ngcontent-%COMP%]:focus{box-shadow:none;border-color:#86b7fe}.btn-comment[_ngcontent-%COMP%]{border-radius:20px;padding:8px 25px;background:#0d6efd;border:none;transition:all .3s}.btn-comment[_ngcontent-%COMP%]:hover{background:#0b5ed7;transform:translateY(-1px)}.comment-actions[_ngcontent-%COMP%]{font-size:.9rem}.comment-actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#6c757d;text-decoration:none;margin-right:15px;transition:color .2s}.comment-actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#0d6efd}.comment-time[_ngcontent-%COMP%]{color:#adb5bd;font-size:.85rem}.reply-section[_ngcontent-%COMP%]{margin-left:60px;border-left:2px solid #e9ecef;padding-left:20px}"]})};var qe=[{path:"",component:H},{path:"details/:id",component:G}],Y=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=N({type:t});static \u0275inj=B({imports:[K.forChild(qe),K]})};var Me=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=N({type:t});static \u0275inj=B({imports:[ae,Y,fe,Se]})};export{Me as MessagesModule};
