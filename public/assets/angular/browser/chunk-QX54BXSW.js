import{a as re}from"./chunk-AKGPCPJK.js";import{a as B,e as H,f as W,g as z,j as y,m as J,n as K,q as Q,r as X,s as Y,u as Z}from"./chunk-ZUXETJBN.js";import{a as ee,b as te,e as oe}from"./chunk-LOXVGAEK.js";import{d as ie}from"./chunk-QVSNJCSE.js";import{Aa as D,Ba as N,Ca as m,Gb as L,Ha as a,Hb as M,I as S,Ja as k,Jb as q,Ma as V,Na as g,O as I,Oa as C,P as F,Pa as s,Q as A,Qa as c,R as T,V as j,Xa as l,Y as h,Z as E,eb as d,f as b,fb as _,ga as $,gb as v,h as x,ha as G,mb as P,sa as n,sb as R,tb as U,wa as O,ya as w}from"./chunk-QYSCFILT.js";var de={imagePreview:"",currentFile:void 0,categories:[],children:[]},u=class i extends te{constructor(e,o){super(de);this._globalStore=e;this._lookupService=o}file$=this.select(e=>e.currentFile);image$=this.select(({imagePreview:e})=>e);children$=this.select(({children:e})=>e);vm$=this.select(e=>({imagePreview:e.imagePreview,categories:e.categories,children:e.children}));getCategories=this.effect(b(F(e=>this._lookupService.getCategories().pipe(ee({next:o=>{let ce=o.filter(r=>r.parent_id===null||r.parent_id===0),se=o.filter(r=>r.parent_id!==null&&r.parent_id!==0),p=[];se.forEach(r=>{p[r.parent_id]||(p[r.parent_id]=[]),p[r.parent_id].push(r)}),console.log("formattedChildren",p),this.patchState({categories:ce,children:p})},error:o=>this._globalStore.setError(ie(o))})))));static \u0275fac=function(o){return new(o||i)(h(oe),h(re))};static \u0275prov=j({token:i,factory:i.\u0275fac,providedIn:"root"})};var f=class i{constructor(t){this.injector=t}onTouched;control;_destroy$=new x;isRequired;_isDisabled;ngOnInit(){try{let t=this.injector.get(W);switch(t.constructor){case Q:this.control=this.injector.get(K).getControl(t),console.log("control",this.control);break}this.isRequired=this.control?.hasValidator(H.required)}catch{this.control=new y}}registerOnChange(t){this.control.valueChanges.pipe(A(this._destroy$),I(this.control.value),S(),T(e=>t(e))).subscribe(()=>this.control?.markAsUntouched())}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._isDisabled=t}writeValue(t){this.control?this.control.setValue(t):this.control=new y(t)}static \u0275fac=function(e){return new(e||i)(O(G))};static \u0275dir=D({type:i,selectors:[["","appControlValueAccessor",""]],standalone:!1})};var le=(i,t)=>t.id;function pe(i,t){if(i&1&&(s(0,"option",10),d(1),c()),i&2){let e=t.$implicit,o=l(6);k("text-danger",o.disableGrandchildren),a("disabled",o.disableGrandchildren)("value",e.id),n(),v(" \xA0\xA0\xA0\xA0\xA0\xA0",e.name," ")}}function me(i,t){if(i&1&&m(0,pe,2,5,"option",9),i&2){let e=l().$implicit,o=l(4);a("ngForOf",o.getChildren(e.id))}}function ue(i,t){if(i&1&&(s(0,"option",7),d(1),c(),m(2,me,1,1,"option",8)),i&2){let e=t.$implicit,o=l(4);a("value",e.id),n(),v(" \xA0\xA0\xA0",e.name," "),n(),V(o.hasChildren(e.id)&&o.displayGrandchildren===!0?2:-1)}}function fe(i,t){if(i&1&&(s(0,"option",6),d(1),c(),g(2,ue,3,3,null,null,le)),i&2){let e=t.$implicit,o=l(3);a("value",e.id),n(),_(e.name),n(),C(o.getChildren(e.id))}}function he(i,t){if(i&1&&(s(0,"select",4)(1,"option",5),d(2,"None"),c(),g(3,fe,4,2,null,null,le),c()),i&2){let e=l().ngIf,o=l();a("formControl",o.control)("id",o.inputId),n(3),C(e.categories)}}function ge(i,t){if(i&1&&(s(0,"div",1)(1,"label",2),d(2),c(),m(3,he,5,2,"select",3),c()),i&2){let e=l();n(),a("for",e.inputId),n(),_(e.label),n(),a("ngIf",e.control)}}var ae=class i extends f{children;displayGrandchildren=!0;disableGrandchildren=!1;label="Category";_store=E(u);vm$=this._store.vm$;category_id;inputId="";ngOnInit(){this._store.getCategories(),this._store.children$.subscribe(t=>{this.children=t})}hasChildren(t){return!!(this.children&&this.children[t])}getChildren(t){return this.children[t]?this.children[t]:[]}static \u0275fac=(()=>{let t;return function(o){return(t||(t=$(i)))(o||i)}})();static \u0275cmp=w({type:i,selectors:[["app-category-selector"]],inputs:{displayGrandchildren:"displayGrandchildren",disableGrandchildren:"disableGrandchildren",label:"label",inputId:"inputId"},standalone:!1,features:[P([{provide:B,multi:!0,useExisting:i}]),N],decls:2,vars:3,consts:[["class","mb-3",4,"ngIf"],[1,"mb-3"],[1,"form-label",3,"for"],["class","form-select",3,"formControl","id",4,"ngIf"],[1,"form-select",3,"formControl","id"],["value",""],[1,"fw-bold",3,"value"],[1,"child-indented",3,"value"],[1,"child-indented",3,"text-danger","disabled","value"],["class","child-indented",3,"text-danger","disabled","value",4,"ngFor","ngForOf"],[1,"child-indented",3,"disabled","value"]],template:function(e,o){e&1&&(m(0,ge,4,3,"div",0),R(1,"async")),e&2&&a("ngIf",U(1,1,o.vm$))},dependencies:[L,M,Y,Z,X,z,J,q],encapsulation:2})};export{ae as a};
