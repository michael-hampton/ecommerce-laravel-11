import{a as Te}from"./chunk-GJMH336B.js";import{a as Ce}from"./chunk-I74O3MZN.js";import"./chunk-PHSYVHON.js";import{a as Fe}from"./chunk-YWFJMAOT.js";import{a as W}from"./chunk-DHAGYSFQ.js";import{b as xe}from"./chunk-AKGPCPJK.js";import{a as Be,b as Ee}from"./chunk-TC2VSDNX.js";import"./chunk-GP456TAF.js";import{b as we}from"./chunk-QYOQXKGA.js";import{c as Ie}from"./chunk-Z2N3KAJX.js";import{c as de,e as h,g as fe,h as ue,j as g,l as ge,n as _e,q as ve,r as he,s as be,u as ye,x as L,z as Se}from"./chunk-ZUXETJBN.js";import{a as S,b as H,e as U}from"./chunk-LOXVGAEK.js";import{d as x}from"./chunk-QVSNJCSE.js";import{Ca as p,Gb as D,Ha as m,Hb as P,Jb as A,Lb as z,Nb as Q,Ob as se,P as j,Pa as a,Qa as i,R as b,Ra as c,Sa as w,Ta as B,V,Va as ae,W as G,Wa as oe,Xa as v,Y as I,Z as _,a as ee,ab as F,b as te,bb as T,ca as ie,cb as N,da as ne,db as q,eb as o,ec as le,fb as d,gb as re,mb as M,sa as l,sb as f,tb as u,u as pe,vb as R,x as ce,xa as $,ya as y,za as O}from"./chunk-QYSCFILT.js";var We={balance:{},loading:!1,data:{},transactions:[]},C=class t extends H{constructor(e,r){super(We);this._api=e;this._globalStore=r}vm$=this.select(e=>({data:e.data,transactions:e.transactions,balance:e.balance,loading:e.loading}));saveWithdrawal=e=>this._api.saveWithdrawal(e).pipe(b(()=>this._globalStore.setLoading(!0)),S({next:r=>this._globalStore.setSuccess("Saved successfully"),error:r=>{this._globalStore.setLoading(!1),this._globalStore.setError(x(r))},finalize:()=>this._globalStore.setLoading(!1)}));getTransactions=this.effect(e=>e.pipe(b(()=>this.patchState({loading:!0})),j(()=>this._api.getTransactions().pipe(b(()=>this.patchState({loading:!0})),S({next:r=>this.patchState({transactions:r}),error:r=>this._globalStore.setError(x(r)),finalize:()=>this.patchState({loading:!1})})))));getData(e){return this.patchState({loading:!0}),this._api.getSeller(e).pipe(S({next:r=>{this.patchState({data:r})},error:r=>this._globalStore.setError(x(r)),finalize:()=>this.patchState({loading:!1})}))}getBalance=this.effect(e=>e.pipe(b(()=>this.patchState({loading:!0})),j(()=>this._api.getBalance().pipe(S({next:r=>this.patchState({balance:r}),error:r=>this._globalStore.setError(x(r)),finalize:()=>this.patchState({loading:!1})})))));updateBalanceActivatedFlag=this.updater(e=>te(ee({},e),{data:te(ee({},e.data),{balance_activated:!0})}));activateBalance=e=>this._api.activateBalance(e).pipe(b(()=>this._globalStore.setLoading(!0)),S({next:r=>{this._globalStore.setSuccess("Saved successfully"),this.updateBalanceActivatedFlag()},error:r=>{this._globalStore.setLoading(!1),this._globalStore.setError(x(r))},finalize:()=>this._globalStore.setLoading(!1)}));static \u0275fac=function(r){return new(r||t)(I(W),I(U))};static \u0275prov=V({token:t,factory:t.\u0275fac})};var je=["activateBalanceModal"],ke=["activateBalanceModalForm"];function Ve(t,n){t&1&&(a(0,"div",12)(1,"div",13)(2,"span",14),o(3,"Loading..."),i()()())}function Ge(t,n){if(t&1&&(w(0),a(1,"small"),o(2),f(3,"currency"),i(),a(4,"h3"),o(5),f(6,"currency"),i(),a(7,"form",15)(8,"div",16)(9,"label",17),o(10,"Amount to withdraw"),i(),c(11,"input",18),i()(),B()),t&2){let e=v().ngIf,r=v();l(2),re(" Pending: ",u(3,3,r.getPending(e.balance))," "),l(3),d(u(6,5,e.balance==null||e.balance.current==null?null:e.balance.current.balance)),l(2),m("formGroup",r.form)}}function $e(t,n){if(t&1){let e=ae();a(0,"button",19),oe("click",function(){ie(e);let s=v(2);return ne(s.activateBalance())}),o(1," Activate Balance "),i()}}function Oe(t,n){if(t&1){let e=ae();a(0,"button",20),oe("click",function(){ie(e);let s=v(2);return ne(s.withdraw())}),o(1,"Withdraw"),i()}}function qe(t,n){if(t&1&&(w(0),a(1,"div",4)(2,"div",5)(3,"h5",6),o(4,"Balance"),i()(),a(5,"div",7),p(6,Ve,4,0,"div",8)(7,Ge,12,7,"ng-container",2)(8,$e,2,0,"button",9),i(),a(9,"div",10),p(10,Oe,2,0,"button",11),i()(),B()),t&2){let e=n.ngIf;l(6),m("ngIf",e.loading),l(),m("ngIf",!e.loading&&e.data.balance_activated),l(),m("ngIf",!e.loading&&!e.data.balance_activated),l(2),m("ngIf",!e.loading)}}function ze(t,n){if(t&1&&(a(0,"option",47),o(1),i()),t&2){let e=n.$implicit;m("value",e.id),l(),re(" ",e.name," ")}}function Qe(t,n){if(t&1&&(a(0,"div",43)(1,"label",40),o(2,"Country"),i(),a(3,"select",44)(4,"option",45),o(5,"Select Country"),i(),p(6,ze,2,2,"option",46),i()()),t&2){let e=n.ngIf;l(6),m("ngForOf",e.countries)}}function Le(t,n){if(t&1&&(a(0,"form",21)(1,"div",22)(2,"div",23)(3,"label",24),o(4,"Name on Account"),i(),c(5,"input",25),i(),a(6,"div",23)(7,"label",24),o(8,"Phone Number"),i(),c(9,"input",26),i()(),a(10,"div",22)(11,"div",23)(12,"label",24),o(13,"Date of Birth"),i(),c(14,"input",27),i(),a(15,"div",23)(16,"label",24),o(17,"Email"),i(),c(18,"input",28),i()(),a(19,"div",22)(20,"div",29)(21,"label",30),o(22,"Website"),i(),c(23,"input",31),i()(),a(24,"div",22)(25,"div",23)(26,"label",24),o(27,"Address"),i(),c(28,"input",32),i(),a(29,"div",23)(30,"label",33),o(31,"Address 2"),i(),c(32,"input",34),i()(),a(33,"div",22)(34,"div",29)(35,"label",30),o(36,"City"),i(),c(37,"input",35),i(),a(38,"div",36)(39,"label",37),o(40,"State"),i(),c(41,"input",38),i(),a(42,"div",39)(43,"label",40),o(44,"Zip"),i(),c(45,"input",41),i(),p(46,Qe,7,1,"div",42),f(47,"async"),i()()),t&2){let e=v();m("formGroup",e.activateBalanceForm),l(46),m("ngIf",u(47,2,e.lookupVm$))}}var Z=class t{_store=_(C);_api=_(W);vm$=this._store.vm$;fb=_(L);form;_modalService=_(we);activateBalanceModal;activateBalanceForm;activateBalanceModalForm;_authService=_(Ce);_lookupStore=_(xe);lookupVm$=this._lookupStore.vm$;ngOnInit(){this._store.getData(Number(this._authService.GetUser().payload.id)).subscribe(),this.initWithdrawBalanceForm(),this._lookupStore.getCountries(),this._store.getBalance()}initWithdrawBalanceForm(){this.form=this.fb.group({amount:new g(0,[h.required])})}getPending(n){let e=0;return!n?.pending_owing&&!n?.pending_owed?0:(n?.pending_owing&&(e-=n.pending_owing),n?.pending_owed&&(e+=n.pending_owed),e)}initActivateBalanceForm(){this.activateBalanceForm=this.fb.group({date_of_birth:new g(""),name:new g("",h.required),email:new g("",h.required),address1:new g("",h.required),address2:new g(""),city:new g("",h.required),state:new g("",h.required),zip:new g("",h.required),country_id:new g("",h.required),phone:new g(""),website:new g("")})}withdraw(){this.form.valid&&this._store.saveWithdrawal({amount:this.form.value.amount}).subscribe(n=>{this._store.getBalance()}),console.log(this.form.value)}activateBalance(){this.initActivateBalanceForm(),ce([this._api.getBilling(),this._api.getSellerBankAccountDetails()]).pipe(pe(([n,e])=>({billingData:n,bankAccountData:e}))).subscribe(n=>{this.activateBalanceForm.patchValue({address1:n.billingData.address1||"",address2:n.billingData.address2||"",city:n.billingData.city||"",state:n.billingData.state||"",zip:n.billingData.zip||"",country_id:n.billingData.country_id,name:n.bankAccountData.account_name||""})}),this._modalService.openConfirmationModal({modalTitle:"Activate Balance",template:this.activateBalanceModalForm,showFooter:!0,saveButtonLabel:"Activate balance",size:"modal-lg"}).subscribe(n=>{this._store.activateBalance(this.activateBalanceForm.value).subscribe()})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=y({type:t,selectors:[["app-balance"]],viewQuery:function(e,r){if(e&1&&(F(je,7,$),F(ke,5)),e&2){let s;T(s=N())&&(r.activateBalanceModal=s.first),T(s=N())&&(r.activateBalanceModalForm=s.first)}},standalone:!1,features:[M([C])],decls:7,vars:3,consts:[["activateBalanceModal",""],["activateBalanceModalForm",""],[4,"ngIf"],["tabindex","-1","id","testModal",1,"modal"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],["class","d-flex justify-content-center overlay",4,"ngIf"],["class","btn btn-primary btn-block",3,"click",4,"ngIf"],[1,"card-footer","text-end"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"d-flex","justify-content-center","overlay"],["role","status",1,"spinner-border",2,"width","6rem","height","6rem"],[1,"visually-hidden"],[3,"formGroup"],[1,"mb-3"],[1,"form-label"],["type","text","id","amount","name","amount","formControlName","amount",1,"form-control"],[1,"btn","btn-primary","btn-block",3,"click"],[1,"btn","btn-primary",3,"click"],["method","post","admin-form","","enctype","multipart/form-data",3,"formGroup"],[1,"row","mb-3"],[1,"form-group","mb-3","col-lg-6"],["for","inputAddress"],["type","text","id","name","name","name","formControlName","name",1,"form-control"],["type","text","id","phone","name","phone","formControlName","phone",1,"form-control"],["type","date","id","date_of_birth","name","date_of_birth","formControlName","date_of_birth",1,"form-control"],["type","text","id","email","name","email","formControlName","email",1,"form-control"],[1,"form-group","col-lg-4"],["for","city"],["type","text","id","website","name","website","formControlName","website",1,"form-control"],["type","text","id","inputAddress","name","address1","placeholder","1234 Main St","formControlName","address1",1,"form-control"],["for","inputAddress2"],["type","text","id","inputAddress2","name","address2","placeholder","Apartment, studio, or floor","formControlName","address2",1,"form-control"],["type","text","id","city","name","city","formControlName","city",1,"form-control"],[1,"form-group","col-lg-4","mb-3"],["for","state"],["type","text","id","state","name","state","formControlName","state",1,"form-control"],[1,"form-group","col-lg-3","mb-3"],["for","inputZip"],["type","text","id","inputZip","name","zip","formControlName","zip",1,"form-control"],["class","form-group mb-3",4,"ngIf"],[1,"form-group","mb-3"],["id","inputCountry","name","country_id","formControlName","country_id",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,r){e&1&&(p(0,qe,11,4,"ng-container",2),f(1,"async"),a(2,"div",3,0),o(4,"..."),i(),p(5,Le,48,4,"ng-template",null,1,R)),e&2&&m("ngIf",u(1,1,r.vm$))},dependencies:[D,P,ge,be,ye,de,he,fe,ue,_e,ve,Be,Ee,A,Q],encapsulation:2})};function Ue(t,n){t&1&&(a(0,"div",3)(1,"div",4)(2,"span",5),o(3,"Loading..."),i()()())}function Ze(t,n){if(t&1&&(a(0,"tr")(1,"td"),o(2),i(),a(3,"td"),o(4),i(),a(5,"td"),o(6),i(),a(7,"td"),o(8),i(),a(9,"td"),o(10),f(11,"currency"),i(),a(12,"td"),o(13),f(14,"currency"),i(),a(15,"td"),o(16),f(17,"currency"),i(),a(18,"td"),o(19),f(20,"currency"),i(),a(21,"td"),o(22),f(23,"date"),i()()),t&2){let e=n.$implicit;l(2),d(e.id),l(2),d(e.customer.name),l(2),d(e.payment_method),l(2),d(e.payment_status),l(2),d(u(11,9,e.total)),l(3),d(u(14,11,e.shipping)),l(3),d(u(17,13,e.discount)),l(3),d(u(20,15,e.commission)),l(3),d(u(23,17,e.created_at))}}function Je(t,n){if(t&1&&(a(0,"table",6)(1,"thead")(2,"tr")(3,"th"),o(4,"Id"),i(),a(5,"th"),o(6,"Customer"),i(),a(7,"th"),o(8,"Payment Method"),i(),a(9,"th"),o(10,"Status"),i(),a(11,"th"),o(12,"Total"),i(),a(13,"th"),o(14,"Shipping"),i(),a(15,"th"),o(16,"Discount"),i(),a(17,"th"),o(18,"Insurance"),i(),a(19,"th"),o(20,"Date"),i()()(),a(21,"tbody"),p(22,Ze,24,19,"tr",7),i()()),t&2){let e=v().ngIf;l(22),m("ngForOf",e.transactions)}}function Ke(t,n){if(t&1&&(w(0),p(1,Ue,4,0,"div",1)(2,Je,23,1,"table",2),B()),t&2){let e=n.ngIf;l(),m("ngIf",e.loading),l(),m("ngIf",!e.loading)}}var J=class t{_store=_(C);vm$=this._store.vm$;fb=_(L);ngOnInit(){this._store.getTransactions()}withdrawFromTransaction(n,e){this._store.saveWithdrawal({amount:n,transactionId:e}).subscribe(r=>{this._store.getBalance()})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=y({type:t,selectors:[["app-transactions"]],standalone:!1,features:[M([C])],decls:2,vars:3,consts:[[4,"ngIf"],["class","d-flex justify-content-center overlay",4,"ngIf"],["class","table table-bordered table-striped",4,"ngIf"],[1,"d-flex","justify-content-center","overlay"],["role","status",1,"spinner-border",2,"width","6rem","height","6rem"],[1,"visually-hidden"],[1,"table","table-bordered","table-striped"],[4,"ngFor","ngForOf"]],template:function(e,r){e&1&&(p(0,Ke,3,2,"ng-container",0),f(1,"async")),e&2&&m("ngIf",u(1,1,r.vm$))},dependencies:[D,P,A,Q,z],encapsulation:2})};var Ye={withdrawals:[],loading:!1},k=class t extends H{constructor(e,r){super(Ye);this._api=e;this._globalStore=r}vm$=this.select(e=>({withdrawals:e.withdrawals,loading:e.loading}));getWithdrawals=this.effect(e=>e.pipe(b(()=>this.patchState({loading:!0})),j(()=>this._api.getWithdrawals().pipe(S({next:r=>this.patchState({withdrawals:r}),error:r=>this._globalStore.setError(x(r)),finalize:()=>this.patchState({loading:!1})})))));static \u0275fac=function(r){return new(r||t)(I(W),I(U))};static \u0275prov=V({token:t,factory:t.\u0275fac})};var et=["activateBalanceModal"],tt=["activateBalanceModalForm"];function it(t,n){t&1&&(a(0,"div",8)(1,"div",9)(2,"span",10),o(3,"Loading..."),i()()())}function nt(t,n){if(t&1&&(a(0,"li",13)(1,"span"),o(2),f(3,"date"),i(),a(4,"span",14),o(5),i()()),t&2){let e=n.$implicit;l(2),d(u(3,2,e.created_at)),l(3),d(e.amount)}}function at(t,n){if(t&1&&(a(0,"ul",11),p(1,nt,6,4,"li",12),i()),t&2){let e=v().ngIf;l(),m("ngForOf",e.withdrawals)}}function ot(t,n){if(t&1&&(w(0),a(1,"div",1)(2,"div",2)(3,"h5",3),o(4,"Withdrawals"),i()(),a(5,"div",4),p(6,it,4,0,"div",5),a(7,"div",6),p(8,at,2,1,"ul",7),i()()(),B()),t&2){let e=n.ngIf;l(6),m("ngIf",e.loading),l(2),m("ngIf",!e.loading)}}var K=class t{_store=_(k);vm$=this._store.vm$;form;activateBalanceModal;activateBalanceForm;activateBalanceModalForm;ngOnInit(){this._store.getWithdrawals()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=y({type:t,selectors:[["app-withdrawals"]],viewQuery:function(e,r){if(e&1&&(F(et,7,$),F(tt,5)),e&2){let s;T(s=N())&&(r.activateBalanceModal=s.first),T(s=N())&&(r.activateBalanceModalForm=s.first)}},standalone:!1,features:[M([k])],decls:2,vars:3,consts:[[4,"ngIf"],[1,"card","mt-3"],[1,"card-header"],[1,"card-title"],[1,"card-body"],["class","d-flex justify-content-center overlay",4,"ngIf"],[2,"height","400px","overflow-y","auto"],["class","list-group",4,"ngIf"],[1,"d-flex","justify-content-center","overlay"],["role","status",1,"spinner-border",2,"width","6rem","height","6rem"],[1,"visually-hidden"],[1,"list-group"],["class","list-group-item d-flex justify-content-between align-items-start",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","justify-content-between","align-items-start"],[1,""]],template:function(e,r){e&1&&(p(0,ot,9,2,"ng-container",0),f(1,"async")),e&2&&m("ngIf",u(1,1,r.vm$))},dependencies:[D,P,A,z],encapsulation:2})};function lt(t,n){t&1&&c(0,"app-balance")(1,"app-withdrawals")}function mt(t,n){t&1&&c(0,"app-transactions")}function pt(t,n){t&1&&o(0," Coming soon ")}var X=class t{page="balance";menuItemChanged(n){this.page=n}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=y({type:t,selectors:[["app-balance-page"]],standalone:!1,decls:11,vars:3,consts:[["balance",""],["history",""],["invoices",""],[1,"container","py-5","bg-white"],["tabName","Balance",3,"templateRef"],["tabName","History",3,"templateRef"],["tabName","Invoices",3,"templateRef"]],template:function(e,r){if(e&1&&(a(0,"div",3)(1,"app-ui-side-menu"),c(2,"app-ui-tab-item",4)(3,"app-ui-tab-item",5)(4,"app-ui-tab-item",6),i(),p(5,lt,2,0,"ng-template",null,0,R)(7,mt,1,0,"ng-template",null,1,R)(9,pt,1,0,"ng-template",null,2,R),i()),e&2){let s=q(6),Re=q(8),De=q(10);l(2),m("templateRef",s),l(),m("templateRef",Re),l(),m("templateRef",De)}},dependencies:[Fe,Te,Z,J,K],encapsulation:2})};var ct=[{path:"",component:X}],Y=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=O({type:t});static \u0275inj=G({imports:[le.forChild(ct),le]})};var Me=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=O({type:t});static \u0275inj=G({imports:[se,Y,Se,Ie]})};export{Me as BalancePageModule};
